# Git Workflow to Prevent Divergent Branches

## The Problem

Divergent branches happen when:
- You commit locally and don't push
- GitHub Actions workflow commits and pushes
- You try to push and get a divergence error

## The Solution

### 1. Always Pull Before Pushing

**Before making local commits:**
```bash
git pull --rebase origin main
```

**Or use the alias:**
```bash
git up  # (if you set up the alias below)
```

### 2. Use Rebase Instead of Merge

We've configured git to use rebase by default:
```bash
git config pull.rebase true
```

This keeps a cleaner history and avoids unnecessary merge commits.

### 3. Recommended Workflow

**When working locally:**
```bash
# 1. Always start by pulling latest
git pull --rebase origin main

# 2. Make your changes
# ... edit files ...

# 3. Commit
git add .
git commit -m "Your message"

# 4. Pull again before pushing (in case workflow ran)
git pull --rebase origin main

# 5. Push
git push origin main
```

### 4. Quick Alias (Optional)

Add this to your `~/.gitconfig`:
```ini
[alias]
    up = pull --rebase origin main
    sync = !git pull --rebase origin main && git push origin main
```

Then you can use:
```bash
git up      # Pull with rebase
git sync    # Pull, then push
```

### 5. What We Fixed in the Workflow

The GitHub Actions workflow now:
- Pulls before committing
- Pulls again before pushing
- Uses rebase to avoid merge commits
- Has retry logic if push fails

### 6. If You Still Get Divergence

**Option A: Rebase (Recommended)**
```bash
git pull --rebase origin main
git push origin main
```

**Option B: Merge (if rebase fails)**
```bash
git pull origin main
# Resolve any conflicts
git push origin main
```

**Option C: Reset (if you haven't pushed your local changes)**
```bash
# Save your work first!
git stash
git pull --rebase origin main
git stash pop
# Resolve conflicts, then commit and push
```

## Best Practices

1. **Always pull before starting work**
2. **Pull again before pushing** (workflow might have run)
3. **Use rebase** to keep history clean
4. **Commit frequently** and push regularly
5. **Check git status** before committing

## Automated Solution

The workflow has been updated to:
- Pull before committing
- Pull before pushing
- Handle conflicts gracefully
- Use rebase to avoid merge commits

This should prevent most divergence issues!

